var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,c,a){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var f=b[e];if(c.call(a,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){b!=Array.prototype&&b!=Object.prototype&&(b[c]=a.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,c,a,d){if(c){a=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in a||(a[e]={});a=a[e]}b=b[b.length-1];d=a[b];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");
define(["cbj"],function(b){var c={initEcListingPage:function(){var a=b("#product-list-data");if(0===a.length)throw"Cannot find product list data in script tag with ID #product-list-data. Template may need an update, compare with original template.";var d=JSON.parse(a.text());c.trackProductImpressions(d);b(".trigger-ga-track-product-click").click(function(a){if(c.gaLoaded()){a.preventDefault();a=b(this);var e=a.attr("href"),g=a.data("id");a=d.find(function(a){return parseInt(a.product_id)===g});c.trackProductClick(a,
function(){document.location=e})}});b(".trigger-ga-track-add-to-cart").click(function(a){if(c.gaLoaded()){a.preventDefault();a=b(this);var e=a.attr("href"),g=a.data("id");a=d.find(function(a){return parseInt(a.product_id)===g});c.trackAddToCart(a,function(){document.location=e})}})},initEcProductPage:function(){var a=b("#product-data");if(0===a.length)throw"Cannot find product page data in script tag with ID #product-data. Template may need an update, compare with original template.";var d=JSON.parse(a.text());
c.trackProductDetailView(d);b(".trigger-ga-track-add-to-cart").click(function(a){if(c.gaLoaded()){a.preventDefault();var e=b(this).attr("href");c.trackAddToCart(d,function(){document.location=e})}})},initEcConfiguratorPage:function(){var a=b("#product-data");if(0===a.length)throw"Cannot find Configurator Page data in script tag with ID #product-data. Template may need an update, compare with original template.";var d=JSON.parse(a.text());c.trackProductImpressions(d);b(".trigger-ga-track-add-to-cart").click(function(a){if(c.gaLoaded()){a.preventDefault();
var e=b(this).attr("href");c.trackAddToCart(d,function(){document.location=e})}})},initEcCartPage:function(){b(".trigger-ga-track-remove-position").click(function(a){if(c.gaLoaded()){a.preventDefault();a=b("#cart-data");if(0===a.length)throw"Cannot find cart page data in script tag with ID #cart-data. Template summary in cart view may need an update, compare with original template.";a=JSON.parse(a.text());var d=b(this),e=d.attr("href"),f=d.attr("data-position-id");if(!f)throw"Cannot find position-id data attribute in the position remove link. Template positioncontrols.php and summary.php in cart view may need an update, compare with original template.";
a=a.find(function(a){return a.positionId===f});c.trackRemoveFromCart(a,function(){document.location=e})}})},initEcCheckoutPage:function(){cbrequire(["configbox/checkout"],function(a){a=a.getOrderMetaData();c.trackCheckoutVisit(a)});b(document).on("cb.checkout.address_saved",function(){c.trackCheckoutFunnelStep(2)});b(document).on("cb.checkout.payment_saved",function(){c.trackCheckoutFunnelStep(3)});b(document).on("cb.checkout.delivery_saved",function(){c.trackCheckoutFunnelStep(4)});b(document).on("cb.checkout.order_placed",
function(){c.trackCheckoutFunnelStep(5)})},ecPluginGotRequired:!1,getGaObject:function(){window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)};window.ga.l=+new Date;!1===c.ecPluginGotRequired&&(window.ga("require","ec"),c.ecPluginGotRequired=!0);return window.ga},getClientId:function(a){var d=c.getGaObject();d(function(){var b=d.getAll();if(0===b.length)throw"Tried to get GA trackers, but none found";b=b[0].get("clientId");a(b)})},gaLoaded:function(){return"undefined"!==typeof c.getGaObject().loaded},
trackProductImpressions:function(a){if(window.gtag)window.gtag("event","view_item_list",{event_category:"configbox",event_label:"Product impressions",items:a});else{var d=c.getGaObject();if(b.isArray(a))for(var e=0;e<a.length;e++)d("ec:addImpression",a[e]);else d("ec:addImpression",a);d("send","event","configbox","view_product_list","Product impressions",{nonInteraction:!0})}},trackProductClick:function(a,b){if(window.gtag)window.gtag("event","select_content",{event_category:"configbox",event_label:"Product click",
items:a,event_callback:b});else{var d=c.getGaObject();d("ec:addProduct",a);d("ec:setAction","click",{list:a.list});d("send","event","configbox","product_click","Product click",{hitCallback:b})}},trackProductDetailView:function(a){if(window.gtag)window.gtag("event","view_item",{event_category:"configbox",event_label:"Product detail view",items:a});else{var b=c.getGaObject();b("ec:addProduct",a);b("ec:setAction","detail");b("send","event","configbox","view_item","Product detail view",{nonInteraction:!0})}},
trackAddToCart:function(a,b){if(window.gtag)window.gtag("event","add_to_cart",{event_category:"configbox",event_label:"Add cart position",items:a,event_callback:b});else{var d=c.getGaObject();d("ec:addProduct",a);d("ec:setAction","add");d("send","event","configbox","add_to_cart","Add cart position",{hitCallback:b})}},trackRemoveFromCart:function(a,b){if(window.gtag)window.gtag("event","remove_to_cart",{event_category:"configbox",event_label:"Remove cart position",items:a,event_callback:b});else{var d=
c.getGaObject();d("ec:addProduct",a);d("ec:setAction","remove");d("send","event","configbox","remove_to_cart","Remove cart position",{hitCallback:b})}},trackCheckoutVisit:function(a){if(window.gtag)window.gtag("set",{currencyCode:a.currencyCode}),window.gtag("event","begin_checkout",{event_category:"configbox",event_label:"checkout start",items:function(){var b=[],d;for(d in a.positions)if(!0===a.positions.hasOwnProperty(d)){var c=a.positions[d];b.push({id:c.productId,position:c.positionId,name:c.productTitle,
price:c.pricePerItemGross,quantity:c.quantity})}return b}});else{var b=c.getGaObject();b("set","currencyCode",a.currencyCode);for(var e in a.positions)if(!0===a.positions.hasOwnProperty(e)){var f=a.positions[e];b("ec:addProduct",{id:f.productId,position:f.positionId,name:f.productTitle,price:f.pricePerItemGross,quantity:f.quantity})}b("ec:setAction","checkout",{step:1});b("send","event","configbox","begin_checkout","checkout start")}},trackCheckoutFunnelStep:function(a){if(window.gtag)window.gtag("event",
"checkout_step",{event_category:"configbox",event_label:"Funnel step",checkout_step:a});else{var b=c.getGaObject();b("ec:setAction","checkout",{step:a});b("send","event","configbox","click","Funnel step")}}};return c});
