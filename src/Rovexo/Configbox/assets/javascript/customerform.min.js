var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,b){a instanceof String&&(a=String(a));for(var d=a.length,c=0;c<d;c++){var f=a[c];if(e.call(b,f,c,a))return{i:c,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,b){if(a==Array.prototype||a==Object.prototype)return a;a[e]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var e=0;e<a.length;++e){var b=a[e];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,e){var b=$jscomp.propertyToPolyfillSymbol[e];if(null==b)return a[e];b=a[b];return void 0!==b?b:a[e]};
$jscomp.polyfill=function(a,e,b,d){e&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,e,b,d):$jscomp.polyfillUnisolated(a,e,b,d))};$jscomp.polyfillUnisolated=function(a,e,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var c=a[d];if(!(c in b))return;b=b[c]}a=a[a.length-1];d=b[a];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:e})};
$jscomp.polyfillIsolated=function(a,e,b,d){var c=a.split(".");a=1===c.length;d=c[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<c.length-1;f++){var g=c[f];if(!(g in d))return;d=d[g]}c=c[c.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[c]:null;e=e(b);null!=e&&(a?$jscomp.defineProperty($jscomp.polyfills,c,{configurable:!0,writable:!0,value:e}):e!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[c]&&($jscomp.propertyToPolyfillSymbol[c]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(c):
$jscomp.POLYFILL_PREFIX+c),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[c],{configurable:!0,writable:!0,value:e})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(e,b){return $jscomp.findInternal(this,e,b).v}},"es6","es3");
define(["cbj","cbj.chosen","cbj.bootstrap"],function(a){var e={initCustomerFormEach:function(){a(".view-customerform .cb-popover").popover();a(".view-customerform .chosen-dropdown").chosen({disable_search_threshold:10})},initCustomerForm:function(){a(document).on("change",".view-customerform .trigger-toggle-same-delivery",function(){if(!0===a(this).prop("checked"))a(this).closest(".customer-form-sections").removeClass("show-delivery-fields");else{if("undefined"===a(this).data("got-toggled")){a(this).data("got-toggled",
!0);var b=a(this).closest(".view-customerform").data("customer-fields"),d=a(this).closest(".view-customerform").find("#form_type").val(),c;for(c in b)if(b.hasOwnProperty(c)){var f=b[c];if("1"==f["show_"+d]&&a("#"+f.field_name).length&&a("#billing"+f.field_name).length){var g=a("#billing"+f.field_name).val();a("input[name="+f.field_name+"]").val(g)}}}a(this).closest(".customer-form-sections").addClass("show-delivery-fields")}});a(document).on("change",".recurring-customer-login #show-login",function(){var b=
a(this).closest(".recurring-customer-login").find(".login-wrapper").show();!0===a(this).prop("checked")?b.show():b.hide()});a(document).on("click",".recurring-customer-login .trigger-login",function(){if(!a(this).hasClass("processing")){a(this).addClass("processing");var b=a(this).closest(".recurring-customer-login");b.find(".feedback").text("");var d=b.find(".input-username").val(),c=b.find(".input-password").val();cbrequire(["configbox/server"],function(f){f.requestLogin(d,c).done(function(g){!1===
g.success?0!==b.find(".login-box .feedback").length?b.find(".login-box .feedback").text(g.errorMessage):window.alert(g.errorMessage):(a(document).trigger("cbLogin"),g=b.closest(".view-customerform").data("view-url"),b.closest(".view-customerform").load(g,function(){a(document).trigger("cbViewInjected")}))}).always(function(){b.find(".login-box .processing").removeClass("processing")})})}});a(document).on("click",".recurring-customer-login .trigger-recover-password",function(){var b=a(this).closest(".login-wrapper").find(".input-username").val();
b&&a(this).closest(".recurring-customer-login").find(".recover-box .input-username").val(b);a(this).closest(".recurring-customer-login").find(".login-box").hide();a(this).closest(".recurring-customer-login").find(".recover-box").show();a(this).closest(".recurring-customer-login").find(".change-password-box").hide()});a(document).on("click",".recurring-customer-login .trigger-cancel-recovery",function(){a(this).closest(".recurring-customer-login").find(".login-box").show();a(this).closest(".recurring-customer-login").find(".recover-box").hide();
a(this).closest(".recurring-customer-login").find(".change-password-box").hide()});a(document).on("keyup",".view-customerform .customer-field .form-control",function(){a(this).closest(".customer-field").removeClass("invalid")});a(document).on("change",".view-customerform .customer-field select",function(){a(this).closest(".customer-field").removeClass("invalid")});a(document).on("click",".recurring-customer-login .trigger-request-verification-code",function(){if(!a(this).hasClass("processing")){a(this).addClass("processing");
var b=a(this).closest(".recover-box").find(".input-username").val(),d=a(this).closest(".recurring-customer-login");d.find(".feedback").text("");cbrequire(["configbox/server"],function(c){c.requestPasswordChangeVerificationCode(b).done(function(f){!1===f.success?0!==d.find(".recover-box .feedback").length?d.find(".recover-box .feedback").text(f.errorMessage):window.alert(f.errorMessage):(d.find(".recover-box").hide(),d.find(".change-password-box").show())}).always(function(){d.find(".recover-box .processing").removeClass("processing")})})}});
a(document).on("click",".recurring-customer-login .trigger-change-password",function(){if(!a(this).hasClass("processing")){a(this).addClass("processing");var b=a(this).closest(".change-password-box").find(".input-verification").val(),d=a(this).closest(".change-password-box").find(".input-new-password").val(),c=a(this).closest(".recurring-customer-login");c.find(".feedback").text("");cbrequire(["configbox/server"],function(f){f.requestPasswordChange(b,d,!0).done(function(g){!1===g.success?a.each(g.errors,
function(k,h){c.find(".change-password-box .feedback").append("<div>"+h.message+"</div>")}):(g=c.closest(".view-customerform").data("view-url"),a(document).trigger("cbLogin"),c.closest(".view-customerform").load(g,function(){a(document).trigger("cbViewInjected")}))}).always(function(){c.find(".processing").removeClass("processing")})})}});a(document).on("keyup",".recurring-customer-login",function(b){if(13===b.which){var d=a(this).closest(".recurring-customer-login");b=a(b.target);0!==b.closest(".login-box").length&&
d.find(".trigger-login").trigger("click");0!==b.closest(".recover-box").length&&d.find(".trigger-request-verification-code").trigger("click");0!==b.closest(".change-password-box").length&&d.find(".trigger-change-password").trigger("click")}});a(document).on("change","select.updates-states",function(){a(this).trigger("chosen:updated");var b=parseInt(a(this).val()),d=a(this).data("state-select-id"),c=a("#"+d);0!==c.length&&(0===b?(c.html('<option value="0" selected="selected"></option>'),c.prop("disabled",
!0),c.trigger("chosen:updated").trigger("change")):cbrequire(["configbox/server"],function(f){f.makeRequest("customerform","getStates",{country_id:b}).done(function(g){c.html("").prop("disabled",!1);0===g.length?c.closest(".customer-field").addClass("has-no-data"):c.closest(".customer-field").removeClass("has-no-data");a.each(g,function(k,h){c.append('<option value="'+h.id+'">'+h.name+"</option>")});c.trigger("chosen:updated").trigger("change")})}))});a(document).on("change",".view-customerform select.updates-counties",
function(){a(this).trigger("chosen:updated");var b=parseInt(a(this).val()),d=a(this).data("county-select-id"),c=a("#"+d);0!==c.length&&(0===b?(c.html('<option value="0" selected="selected"></option>'),c.prop("disabled",!0),c.trigger("chosen:updated").trigger("change")):cbrequire(["configbox/server"],function(f){f.makeRequest("customerform","getCounties",{state_id:b}).done(function(g){c.html("").prop("disabled",!1);0===g.length?c.closest(".customer-field").addClass("has-no-data"):c.closest(".customer-field").removeClass("has-no-data");
a.each(g,function(k,h){c.append('<option value="'+h.id+'">'+h.county_name+"</option>")});c.trigger("chosen:updated").trigger("change")})}))});a(document).on("change",".view-customerform select.updates-cities",function(){a(this).trigger("chosen:updated");var b=parseInt(a(this).val()),d=a(this).data("city-select-id"),c=a("#"+d);if(0!==c.length)if(0===b){c.val("0").trigger("chosen:updated").trigger("change");c.closest(".customer-field").addClass("uses-textfield-instead");var f=d.replace("_id","");c.closest(".view-customerform").find(".customer-field-"+
f).removeClass("uses-dropdown-instead")}else cbrequire(["configbox/server"],function(g){g.makeRequest("customerform","getCities",{county_id:b}).done(function(k){c.html("").prop("disabled",!1);if(0===k.length)c.val("0").trigger("chosen:updated").trigger("change"),c.closest(".customer-field").addClass("uses-textfield-instead"),k=d.replace("_id",""),c.closest(".view-customerform").find(".customer-field-"+k).removeClass("uses-dropdown-instead");else{c.closest(".customer-field").removeClass("has-no-data uses-textfield-instead");
var h=d.replace("_id","");a("#"+h).val("");c.closest(".view-customerform").find(".customer-field-"+h).addClass("uses-dropdown-instead");a.each(k,function(m,l){c.append('<option value="'+l.id+'">'+l.city_name+"</option>")});c.trigger("change").trigger("chosen:updated")}})})})},getCustomerFormData:function(){var b={};a(".kenedo-view.view-customerform :input").each(function(d,c){a(c).attr("name")&&(a(c).is("input[type=radio]")&&!0===a(c).prop("checked")?b[a(c).attr("name")]=a(c).val():a(c).is("input[type=checkbox]")?
b[a(c).attr("name")]=!0===a(c).prop("checked")?"1":"0":b[a(c).attr("name")]=a(c).val())});"1"===b.samedelivery&&a.each(b,function(d,c){0===d.indexOf("billing")&&(d=d.substr(7),"undefined"!==typeof b[d]&&(b[d]=c))});return b},displayValidationIssues:function(b){a(".view-customerform .customer-field:visible").removeClass("invalid").addClass("valid");for(var d in b)b.hasOwnProperty(d)&&(a(".customer-field-"+b[d].fieldName).removeClass("valid").addClass("invalid"),a(".customer-field-"+b[d].fieldName).find(".validation-tooltip").data("content",
b[d].message));e.initValidationTooltips()},removeValidationIssues:function(){a(".view-customerform .customer-field:visible").removeClass("invalid").removeClass("valid");a(".view-customerform .validation-tooltip").data("content","");e.initValidationTooltips()},initValidationTooltips:function(){a(".validation-tooltip").each(function(){var b={placement:"undefined"!==typeof a(this).data("placement")?a(this).data("placement"):"top",trigger:"undefined"!==typeof a(this).data("trigger")?a(this).data("trigger"):
"hover",delay:"undefined"!==typeof a(this).data("delay")?a(this).data("delay"):200,html:"undefined"!==typeof a(this).data("html")?a(this).data("html"):!0};a(this).popover(b)})}};return e});
