var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,f,b){c instanceof String&&(c=String(c));for(var g=c.length,a=0;a<g;a++){var d=c[a];if(f.call(b,d,a,c))return{i:a,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,b){if(c==Array.prototype||c==Object.prototype)return c;c[f]=b.value;return c};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,c,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<c.length;++f){var b=c[f];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(c,f){var b=$jscomp.propertyToPolyfillSymbol[f];if(null==b)return c[f];b=c[b];return void 0!==b?b:c[f]};
$jscomp.polyfill=function(c,f,b,g){f&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(c,f,b,g):$jscomp.polyfillUnisolated(c,f,b,g))};$jscomp.polyfillUnisolated=function(c,f,b,g){b=$jscomp.global;c=c.split(".");for(g=0;g<c.length-1;g++){var a=c[g];if(!(a in b))return;b=b[a]}c=c[c.length-1];g=b[c];f=f(g);f!=g&&null!=f&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:f})};
$jscomp.polyfillIsolated=function(c,f,b,g){var a=c.split(".");c=1===a.length;g=a[0];g=!c&&g in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in g))return;g=g[e]}a=a[a.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?g[a]:null;f=f(b);null!=f&&(c?$jscomp.defineProperty($jscomp.polyfills,a,{configurable:!0,writable:!0,value:f}):f!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[a]&&($jscomp.propertyToPolyfillSymbol[a]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(a):
$jscomp.POLYFILL_PREFIX+a),$jscomp.defineProperty(g,$jscomp.propertyToPolyfillSymbol[a],{configurable:!0,writable:!0,value:f})))};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(f,b){return $jscomp.findInternal(this,f,b).v}},"es6","es3");
define(["cbj","configbox/configurator"],function(c,f){var b={checkParamUpdateResult:function(a){if(null!=a.err)console.warn("Problem occurred with updating SD parameter values. Result and error stack follow."),console.log(a),console.error(a.err.stack);else{var d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=a.data[d];"value_ok"!=e.result?console.warn("Parameter "+e.id+' received invalid value "'+e.value+'". Result code was '+e.result):console.log("Parameter "+e.id+' update to value "'+e.value+
'" successful.')}}},runSettingsRegisteredFunctions:function(a){b.settingsRegistered=!0;for(var d in b.settingsRegisteredFunctions)b.settingsRegisteredFunctions.hasOwnProperty(d)&&(b.settingsRegisteredFunctions[d](a.api),b.settingsRegisteredFunctions.shift())},settingsRegisteredFunctions:[],settingsRegistered:!1,runSceneReadyFunctions:function(a){b.sceneReady=!0;for(var d in b.sceneReadyFunctions)b.sceneReadyFunctions.hasOwnProperty(d)&&(b.sceneReadyFunctions[d](a.api),b.sceneReadyFunctions.shift())},
sceneReadyFunctions:[],sceneReady:!1,updateFileParameters:function(a){var d=c(".view-sdvisualization").data("used-images"),e={},h;for(h in d)e.$jscomp$loop$prop$i$1=h,d.hasOwnProperty(e.$jscomp$loop$prop$i$1)&&b.getBlobFromUrl(d[e.$jscomp$loop$prop$i$1].url,function(k){return function(l){a.parameters.updateAsync({id:d[k.$jscomp$loop$prop$i$1].parameter_id,value:l}).then(b.checkParamUpdateResult)}}(e)),e={$jscomp$loop$prop$i$1:e.$jscomp$loop$prop$i$1}},getBlobFromUrl:function(a,d){var e=new XMLHttpRequest;
e.open("GET",a);e.responseType="blob";e.onload=function(){d(this.response)};e.send()},getDataUri:function(a,d){var e=new window.Image;e.onload=function(){var h=document.createElement("canvas");h.width=this.naturalWidth;h.height=this.naturalHeight;h.getContext("2d").drawImage(this,0,0);d(h.toDataURL("image/png"))};e.src=a}},g={initFrontendOnce:function(){c(document).on("cbSelectionChange",g.updateVisualization);var a=g.getViewerSettings();a.deferGeometryLoading=!1;var d=c(".view-sdvisualization").data("parameters");
g.initApi(a);g.addSettingsRegisteredFunction(function(e){e.parameters.updateAsync(d).then(b.checkParamUpdateResult).then(e.scene.camera.zoomAsync);b.updateFileParameters(e)})},initApi:function(a){var d=window.define.amd;window.define.amd=null;c.ajax({url:"https://viewer.shapediver.com/v2/2.28.0/sdv.concat.min.js",dataType:"script",complete:function(){window.define.amd=d},success:function(){var e=new SDVApp.ParametricViewer(a);g.setApi(e);e.addEventListener(e.EVENTTYPE.SETTINGS_REGISTERED,b.runSettingsRegisteredFunctions);
e.addEventListener(e.EVENTTYPE.SETTINGS_REGISTERED,function(){e.scene.addEventListener(e.scene.EVENTTYPE.SUBSCENE_PUBLISHED,b.runSceneReadyFunctions)})}})},addSettingsRegisteredFunction:function(a){!0===b.settingsRegistered?a(g.getApi()):b.settingsRegisteredFunctions.push(a)},addSceneReadyFunction:function(a){!0===b.sceneReady?a(g.getApi()):b.sceneReadyFunctions.push(a)},getApi:function(){return g.api},setApi:function(a){window.api=a;g.api=a},getViewerSettings:function(a){var d=c(".view-sdvisualization").data("ticket"),
e=c(".view-sdvisualization").data("model-view-url");d={container:document.getElementById("sdv-container"),ticket:d,modelViewUrl:e,apiversion:2,deferGeometryLoading:!0,brandedMode:!1};for(var h in a)a.hasOwnProperty(h)&&(d[h]=a[h]);return d},updateVisualization:function(a,d,e){(a=g.getParameterData(d,e))&&g.getApi().parameters.updateAsync([a]).then(b.checkParamUpdateResult)},getParameterData:function(a,d){if(!f.getQuestionPropValue(a,"is_shapediver_control"))return null;var e=f.getQuestionPropValue(a,
"shapediver_parameter_id");if(!e)return null;var h=null;switch(f.getQuestionPropValue(a,"question_type")){case "colorpicker":d&&(h="0x"+d.replace("#","")+"ff");break;case "ralcolorpicker":d&&(d=d.replace("RAL ",""),h="0x"+c("#question-"+a).find(".ral-color[data-color-id="+d+"]").data("hex").replace("#","").toLowerCase()+"ff");break;case "upload":h=d?c("#question-"+a).data("file"):"";break;default:h=(a=f.getQuestionPropValue(a,"answers"))&&"undefined"!==typeof a[d]?a[d].shapediver_choice_value:d}return{id:e,
value:h}}};return g});
