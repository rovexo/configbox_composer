var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,e,a){c instanceof String&&(c=String(c));for(var g=c.length,b=0;b<g;b++){var d=c[b];if(e.call(a,d,b,c))return{i:b,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,e,a){if(c==Array.prototype||c==Object.prototype)return c;c[e]=a.value;return c};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,c,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var e=0;e<c.length;++e){var a=c[e];if(a&&a.Math==Math)return a}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(c,e){var a=$jscomp.propertyToPolyfillSymbol[e];if(null==a)return c[e];a=c[a];return void 0!==a?a:c[e]};
$jscomp.polyfill=function(c,e,a,g){e&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(c,e,a,g):$jscomp.polyfillUnisolated(c,e,a,g))};$jscomp.polyfillUnisolated=function(c,e,a,g){a=$jscomp.global;c=c.split(".");for(g=0;g<c.length-1;g++){var b=c[g];if(!(b in a))return;a=a[b]}c=c[c.length-1];g=a[c];e=e(g);e!=g&&null!=e&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:e})};
$jscomp.polyfillIsolated=function(c,e,a,g){var b=c.split(".");c=1===b.length;g=b[0];g=!c&&g in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var d=0;d<b.length-1;d++){var f=b[d];if(!(f in g))return;g=g[f]}b=b[b.length-1];a=$jscomp.IS_SYMBOL_NATIVE&&"es6"===a?g[b]:null;e=e(a);null!=e&&(c?$jscomp.defineProperty($jscomp.polyfills,b,{configurable:!0,writable:!0,value:e}):e!==a&&(void 0===$jscomp.propertyToPolyfillSymbol[b]&&($jscomp.propertyToPolyfillSymbol[b]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(b):
$jscomp.POLYFILL_PREFIX+b),$jscomp.defineProperty(g,$jscomp.propertyToPolyfillSymbol[b],{configurable:!0,writable:!0,value:e})))};$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(e,a){return $jscomp.findInternal(this,e,a).v}},"es6","es3");
define(["configbox/server","kenedo","cbj","cbj.ui","cbj.chosen"],function(c,e,a){var g={initProductTreeOnce:function(){a(document).on("change",".view-adminproducttree #product_tree_list_id",function(){var b=a(this).val(),d=a(this).closest(".view-adminproducttree").find(".product-list").data("update-url");a(this).closest(".product-tree-wrapper").load(d,{list_id:b},function(f,k){"error"===k?window.alert("System Error!"):a(document).trigger("cbViewInjected")})});a(document).on("keyup",".view-adminproducttree #product-tree-title",
function(){var b=a(this).val().toLowerCase();a(".product-edit-link").each(function(){-1===a(this).text().toLowerCase().indexOf(b)?a(this).closest(".product-item").hide():a(this).closest(".product-item").show()})});a(document).on("click",".view-adminproducttree .sub-list-trigger",function(){a(this).is(".trigger-opened")?(a(this).removeClass("trigger-opened"),a(this).siblings(".sub-list").removeClass("list-opened")):(a(this).addClass("trigger-opened"),a(this).siblings(".sub-list").addClass("list-opened"))});
a(document).on("click",".view-adminproducttree .edit-link, .view-adminproducttree .add-link",function(){a(this).closest(".view-adminproducttree").find(".active").removeClass("active");a(this).closest("li").addClass("active")});a(document).on("click",".view-adminproducttree .toggle-tree-edit",function(){a(this).toggleClass("active");a(this).closest(".product-tree-wrapper").toggleClass("shows-edit-buttons")});a(document).on("click",".view-adminproducttree .trigger-copy",function(){var b=a(this).data("controller"),
d=a(this).data("id"),f=a(this).data("short-name");cbrequire(["configbox/server"],function(k){k.makeRequest(b,"copy",{id:d}).done(function(h){if(!1===h.success)window.alert(h.errors.join("\n"));else{h.redirectUrl&&e.loadSubview(h.redirectUrl);var l=a(".view-adminproducttree .product-list").data("update-url"),m=encodeURIComponent(JSON.stringify(g.getOpenProductTreeBranchIds()));l+="&open_branch_ids="+m;a(".product-tree-wrapper").load(l,function(){a(document).trigger("cbViewInjected");a(this).closest(".view-adminproducttree").find(".active").removeClass("active");
var n="#"+f+"-"+h.newId;a(this).closest(".view-adminproducttree").find(n).addClass("active")})}})})});a(document).on("click",".view-adminproducttree .trigger-remove",function(){var b=a(this);if(!b.hasClass("processing")){b.addClass("processing");var d=a(this).closest("li");a.ajax({url:b.data("url"),dataType:"json",success:function(f){b.removeClass("processing");!1===f.success?window.alert(f.errors.join("\n")):d.remove()},error:function(f,k,h){console.log(k);console.log(h)},always:function(){b.removeClass("processing")}})}});
a(document).on("cbFormTaskResponseReceivedGlobal",function(b,d,f){try{var k=JSON.parse(d.responseText)}catch(m){console.warn('Could not parse JSON response. Response text was: "'+d.responseText+'"');console.warn("Error message follows:");console.warn(m);return}if(!0===k.success&&k.data){var h;b=k.data.id;d=f.viewName.replace("admin","");var l=!1;"adminproduct"===f.viewName&&(b=h=k.data.id,l=k.wasInsert);"adminpage"===f.viewName&&(h=k.data.product_id);"adminelement"===f.viewName&&(f=k.data.page_id,
h=a(".view-adminproducttree").find("#page-"+f).closest(".product-item").attr("id").replace("product-",""));g.refreshProductTree(b,d,h,l)}})},initProductTreeEach:function(){a("#product_tree_list_id").chosen();g.makeTreeSortable()},makeTreeSortable:function(){var b={placeholder:"ui-state-highlight",items:">li:not(.add-item)",update:function(){var d=a(this),f=d.sortable("toArray");d.sortable("disable");var k="",h="";d.is(".page-list")&&(k="adminpages",h="page-");d.is(".question-list")&&(k="adminelements",
h="question-");d.is(".answer-list")&&(k="adminoptionassignments",h="answer-");var l=10,m={},n;for(n in f)if(f.hasOwnProperty(n)&&-1!==f[n].indexOf(h)){var p=f[n].replace(h,"");m[p]=l;l+=10}f={updates:JSON.stringify(m)};c.makeRequest(k,"storeOrdering",f).done(function(){d.sortable("enable")})}};a(".sub-list-trigger.product-title").one("click",function(){var d=a(this).closest("li").find(".page-list");window.setTimeout(function(){d.sortable(b).disableSelection()},100)});a(".sub-list-trigger.configurator-page-title").one("click",
function(){var d=a(this).closest("li").find(".question-list");window.setTimeout(function(){d.sortable(b).disableSelection()},100)});a(".view-adminproducttree .list-opened").sortable(b).disableSelection()},refreshProductTree:function(b,d,f,k){if(0!==a(".view-adminproducttree").length){var h=a(".view-adminproducttree .product-list").data("update-url"),l=encodeURIComponent(JSON.stringify(this.getOpenProductTreeBranchIds()));"magento"===c.config.platformName?h+="open_branch_ids/"+l+"/only_product_id/"+
f:(h+=-1===h.indexOf("?")?"?":"&",h+="open_branch_ids="+l+"&only_product_id="+f);k&&a(".view-adminproducttree .product-list .product-item.add-item").before('<li class="product-item" id="product-'+f+'"></li>');a("#product-"+f).load(h+" #product-"+f+">div",function(){a(".view-adminproducttree .active").removeClass("active");"element"===d&&(d="question");a("#"+d+"-"+b).addClass("active");g.makeTreeSortable()})}},getOpenProductTreeBranchIds:function(){var b={products:[],pages:[],questions:[]};a(".sub-list-trigger").each(function(d,
f){a(f).is(".trigger-opened")&&(d=a(this).attr("id"))&&(-1!==d.indexOf("product-trigger")&&b.products.push(d.replace("product-trigger-","")),-1!==d.indexOf("page-trigger")&&b.pages.push(d.replace("page-trigger-","")),-1!==d.indexOf("question-trigger")&&b.questions.push(d.replace("question-trigger-","")))});return b}};return g});
