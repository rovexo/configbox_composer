var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,e){a instanceof String&&(a=String(a));for(var b=a.length,c=0;c<b;c++){var f=a[c];if(d.call(e,f,c,a))return{i:c,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,e){if(a==Array.prototype||a==Object.prototype)return a;a[d]=e.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var d=0;d<a.length;++d){var e=a[d];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,d){var e=$jscomp.propertyToPolyfillSymbol[d];if(null==e)return a[d];e=a[e];return void 0!==e?e:a[d]};
$jscomp.polyfill=function(a,d,e,b){d&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,d,e,b):$jscomp.polyfillUnisolated(a,d,e,b))};$jscomp.polyfillUnisolated=function(a,d,e,b){e=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var c=a[b];if(!(c in e))return;e=e[c]}a=a[a.length-1];b=e[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:d})};
$jscomp.polyfillIsolated=function(a,d,e,b){var c=a.split(".");a=1===c.length;b=c[0];b=!a&&b in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<c.length-1;f++){var l=c[f];if(!(l in b))return;b=b[l]}c=c[c.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?b[c]:null;d=d(e);null!=d&&(a?$jscomp.defineProperty($jscomp.polyfills,c,{configurable:!0,writable:!0,value:d}):d!==e&&(void 0===$jscomp.propertyToPolyfillSymbol[c]&&($jscomp.propertyToPolyfillSymbol[c]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(c):
$jscomp.POLYFILL_PREFIX+c),$jscomp.defineProperty(b,$jscomp.propertyToPolyfillSymbol[c],{configurable:!0,writable:!0,value:d})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(d,e){return $jscomp.findInternal(this,d,e).v}},"es6","es3");
define(["cbj","configbox/shapediverV2"],function(a,d){var e={initBackendPropsEach:function(){a(".view-adminproduct .task-apply a").click(function(){e.setPropertyJson()})},initBackendPropsOnce:function(){a(document).on("click",".trigger-load-model-data",function(){var b=a(this);if(!b.hasClass("processing")){b.addClass("processing");b.css("width",b.css("width"));b.data("ready-text",b.text());b.text(b.data("processing-text"));var c=a(this).closest(".property-type-shapedivermodel"),f=c.find(".model-ticket"),
l=c.find(".model-parameters"),p=c.find(".model-textured-geometries"),n=c.find(".model-view-url-override");0!==c.find(".shapediver-container").length&&c.find(".shapediver-container").remove();c.append('<div class="shapediver-container" style="display:none"></div>');var q=c.find(".shapediver-container").get(0);(f=f.val())?(c.find(".feedback-box").text(""),c=d.getViewerSettings(),c.container=q,c.ticket=f,c.deferGeometryLoading=!1,c.modelViewUrl="https://sdeuc1.eu-central-1.shapediver.com",n.val()&&(c.modelViewUrl=
n.val()),d.addSceneReadyFunction(function(h){var g=h.parameters.get();console.log("Model parameters:");console.log(g);if(null!==g.err)b.text(b.data("ready-text")),b.removeClass("btn-success"),b.removeClass("processing"),console.log("Could not fetch model parameters"),window.alert("A problem has occurred with loading model parameters. Please check ticket and your model and try again.");else{var m={},k;for(k in g.data)!0===g.data.hasOwnProperty(k)&&(m[g.data[k].id]=g.data[k]);h=h.scene.get(null,"CommPlugin_1");
console.log("Scene assets:");console.log(h);g={};for(k in h.data)!0===h.data.hasOwnProperty(k)&&(g[h.data[k].id]=h.data[k].name);l.val(JSON.stringify(m));p.val(JSON.stringify(g));console.log("Collected parameters and geometries");console.log(m);console.log(g);e.setPropertyJson();b.text(b.data("done-text"));b.addClass("btn-success");window.setTimeout(function(){b.text(b.data("ready-text"));b.removeClass("btn-success");b.removeClass("processing")},1E3)}}),d.initApi(c)):c.find(".feedback-box").text("Please enter a ticket number")}})},
setPropertyJson:function(){var b=a(".property-type-shapedivermodel"),c={ticket:b.find(".model-ticket").val(),parameterData:JSON.parse(b.find(".model-parameters").val()),texturedGeometries:JSON.parse(b.find(".model-textured-geometries").val()),modelViewUrlOverride:b.find(".model-view-url-override").val()};b.find(".shapediver-model-data").val(JSON.stringify(c))}};return e});
